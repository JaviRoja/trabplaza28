<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Proyecto Completo</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; max-width: 1400px; margin: auto; background-color: #f4f4f4; }
    header, footer { text-align: center; padding: 10px; background: #222; color: #fff; margin-bottom: 20px; }
    main { background: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
    .grid { display: flex; justify-content: space-between; gap: 40px; flex-wrap: wrap; }
    .form-section, .calculadora, .descuento, .tabla-clave { margin-top: 20px; flex: 1; min-width: 300px; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #000; padding: 10px; text-align: center; font-size: 18px; }
    input[type=number], input[type=text], textarea { width: 100%; margin: 5px 0; padding: 8px; font-size: 16px; box-sizing: border-box; }
    textarea { height: 100px; }
    button { margin: 5px 0; padding: 10px 15px; font-size: 16px; cursor: pointer; background: #007BFF; color: #fff; border: none; border-radius: 5px; }
    button:hover { background: #0056b3; }
    .resultado { font-weight: bold; margin-top: 10px; font-size: 18px; }
    .table-container { margin-top: 30px; text-align: center; }
    .calculadora input[type=text] { font-size: 20px; text-align: right; padding: 10px; margin-bottom: 10px; }
  </style>
</head>
<body>
  <header>
    <h1>Proyecto Completo</h1>
  </header>

  <main>
    <section class="form-section">
      <h2>Ingreso de la Semana</h2>
      <label for="semana">Semana: </label>
      <input type="text" id="semana" placeholder="Ej: 21 al 27">
      <form id="ingresoForm">
        <div id="diasContainer"></div>
        <button type="button" onclick="agregarCampos()">Agregar ingresos diarios</button><br>
        <button type="button" onclick="calcularTotal()">Calcular Total y Guardar</button>
      </form>
      <div class="resultado" id="resultado"></div>
    </section>

    <section class="grid">
      <div class="calculadora">
        <h2>Calculadora</h2>
        <input type="text" id="pantalla" disabled>
        <div>
          <button onclick="agregar('7')">7</button>
          <button onclick="agregar('8')">8</button>
          <button onclick="agregar('9')">9</button>
          <button onclick="agregar('/')">/</button><br>
          <button onclick="agregar('4')">4</button>
          <button onclick="agregar('5')">5</button>
          <button onclick="agregar('6')">6</button>
          <button onclick="agregar('*')">*</button><br>
          <button onclick="agregar('1')">1</button>
          <button onclick="agregar('2')">2</button>
          <button onclick="agregar('3')">3</button>
          <button onclick="agregar('-')">-</button><br>
          <button onclick="agregar('0')">0</button>
          <button onclick="agregar('.')">.</button>
          <button onclick="agregar('%')">%</button>
          <button onclick="agregar('+')">+</button><br>
          <button onclick="limpiarPantalla()">C</button>
          <button onclick="calcularResultado()">=</button>
        </div>
      </div>

      <div>
        <h2>Espacio para operaciones</h2>
        <textarea id="textarea-operaciones" placeholder="Escribe aquí tus operaciones..."></textarea>
        <button onclick="sumarValores()">Sumar valores</button>
        <div class="resultado" id="resultado-suma"></div>
      </div>
    </section>

    <section class="descuento">
      <h2>Calculadora de Descuentos</h2>
      <input type="number" id="precio-original" placeholder="Precio original">
      <button onclick="aplicarDescuento(19)">Aplicar 19%</button>
      <button onclick="aplicarDescuento(16)">Aplicar 16%</button>
      <div class="resultado" id="resultado-descuento"></div>
    </section>
    <section class="descuento">
      <h2>Calculadora Porcientos</h2>
      <input type="number" id="porcentaje-input" placeholder="Ingrese un valor">
      <button onclick="calcularPorcentaje(4)">Calcular 4%</button>
      <button onclick="calcularPorcentaje(5)">Calcular 5%</button>
      <button onclick="calcularPorcentaje(7)">Calcular 7%</button>
      <button onclick="calcularPorcentaje(40)">Calcular 40%</button>
      <div class="resultado" id="resultado-porcentaje"></div>
    </section>
    
    <script>
      function calcularPorcentaje(porcentaje) {
        const valor = parseFloat(document.getElementById("porcentaje-input").value);
        if (isNaN(valor)) {
          document.getElementById("resultado-porcentaje").innerText = "Ingrese un número válido.";
          return;
        }
        const resultado = valor * (porcentaje / 100);
        document.getElementById("resultado-porcentaje").innerText = `${porcentaje}% de ${valor} es: ${resultado.toFixed(2)}`;
      }
    </script>
    
    <section id="tabla-clave" class="table-container">
      <h2>Tabla de Claves Interactiva</h2>
      <p>D=1, E=2, P=3, O=4, R=5, T=6, I=7, V=8, A=9, S=0</p>
      <input type="text" id="claveInput" placeholder="Introduce las letras (ej. DTS)">
      <button onclick="convertirClave()">Convertir</button>
      <div class="resultado" id="resultado-clave"></div>
    </section>
  </main>

  <footer>
    <p>Proyecto desarrollado por Javier</p>
  </footer>

  <script>
    function agregarCampos() {
      const contenedor = document.getElementById("diasContainer");
      contenedor.innerHTML = "";
      ["Lunes", "Martes", "Miércoles", "Jueves", "Viernes", "Sábado", "Domingo"].forEach(dia => {
        const input = document.createElement("input");
        input.type = "number";
        input.placeholder = dia;
        contenedor.appendChild(input);
      });
    }

    function calcularTotal() {
      const semana = document.getElementById("semana").value.trim();
      const inputs = document.querySelectorAll("#diasContainer input[type=number]");
      let total = 0;

      inputs.forEach(input => {
        total += parseFloat(input.value) || 0;
      });

      const contenido = `Ingresos de la semana ${semana}\nTotal: ${total.toFixed(2)}`;
      document.getElementById("resultado").innerText = contenido;

      const blob = new Blob([contenido], { type: "text/plain;charset=utf-8" });
      const enlace = document.createElement("a");
      enlace.href = URL.createObjectURL(blob);
      enlace.download = `ingreso_semanal_${semana.replace(/\s+/g, "_")}.txt`;
      enlace.click();
    }

    function agregar(valor) {
      const pantalla = document.getElementById("pantalla");
      if (valor === "%") {
        pantalla.value += "/100";
      } else {
        pantalla.value += valor;
      }
    }

    function limpiarPantalla() {
      document.getElementById("pantalla").value = "";
    }

    function calcularResultado() {
      try {
        const resultado = eval(document.getElementById("pantalla").value);
        document.getElementById("pantalla").value = resultado || "Error";
      } catch {
        document.getElementById("pantalla").value = "Error";
      }
    }

    function sumarValores() {
      const texto = document.getElementById("textarea-operaciones").value;
      const valores = texto.match(/-?\d+(\.\d+)?/g);
      if (!valores) {
        document.getElementById("resultado-suma").innerText = "No se encontraron números.";
        return;
      }
      const suma = valores.reduce((total, num) => total + parseFloat(num), 0);
      document.getElementById("resultado-suma").innerText = `Suma: ${suma.toFixed(2)}`;
    }

    function aplicarDescuento(porcentaje) {
      const precio = parseFloat(document.getElementById("precio-original").value);
      if (isNaN(precio)) {
        document.getElementById("resultado-descuento").innerText = "Ingrese un precio válido.";
        return;
      }
      const descuento = precio * porcentaje / 100;
      const total = precio - descuento;
      document.getElementById("resultado-descuento").innerText = `Precio con ${porcentaje}% de descuento: ${total.toFixed(2)}`;
    }

    function convertirClave() {
      const claves = {
        D: '1', E: '2', P: '3', O: '4', R: '5', T: '6', I: '7', V: '8', A: '9', S: '0'
      };
      const input = document.getElementById("claveInput").value.toUpperCase();
      let resultado = "";
      for (let letra of input) {
        resultado += claves[letra] !== undefined ? claves[letra] : "?";
      }
      document.getElementById("resultado-clave").innerText = `Resultado: ${resultado}`;
    }
  </script>
</body>
</html>